---
// @ts-ignore
import { getSlideContent } from '../data/slideContent.js'
import Swiper from 'swiper'
import { Navigation, Pagination } from 'swiper/modules'
import 'swiper/css'
import 'swiper/css/navigation'
import 'swiper/css/pagination'

// @ts-ignore - Astro global is available in .astro files
const { lang = 'cs' } = Astro.props

const slidesContent = getSlideContent(lang)
---

<section class="hero-section">
    <div class="swiper">
        <div class="swiper-wrapper">
            {
                slidesContent.map((slide, index) => (
                    <div class={`swiper-slide ${slide.customClass ? slide.customClass : ''}`}>
                        <picture class="slide-image-wrapper">
                            {/* Mobile image */}
                            <source
                                media="(max-width: 767px)"
                                srcset={slide.imageMobile || slide.image}
                            />
                            {/* Desktop image */}
                            <img
                                src={slide.image}
                                alt={slide.title}
                                class="slide-image"
                                loading={index === 0 ? 'eager' : 'lazy'}
                                fetchpriority={index === 0 ? 'high' : 'auto'}
                                decoding={index === 0 ? 'sync' : 'async'}
                            />
                        </picture>
                        <div class="slide-content container">
                            <p class="hero-subtitle">{slide.subtitle}</p>
                            <h2 class="hero-title">{slide.title}</h2>
                            <a href={slide.buttonLink} class="btn">
                                {slide.buttonText}
                            </a>
                        </div>
                    </div>
                ))
            }
        </div>

        <div class="swiper-pagination"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>
</section>

<script>
    // No JavaScript needed for image loading anymore!
    // Native loading="lazy" handles lazy loading
    // <picture> with <source> handles responsive images
    // fetchpriority="high" on first image ensures LCP priority
</script>

<style lang="scss">
    // Slide-specific image positioning
    .slide-content--klimatizace {
        .slide-image {
            transform: scaleX(-1);
        }
    }
    .slide-content--klempir {
        .slide-image {
            object-position: center -188rem;
        }
    }
    .slide-content--deformace {
        .slide-image {
            @media (min-width: 1024px) {
                object-position: center -87px !important;
            }
        }
    }
    .slide-content--ochrane-nastriky {
        .slide-image {
            @media (min-width: 1024px) {
                object-position: center -34rem !important;
            }
        }
    }

    .hero-section {
        .swiper-pagination {
            bottom: 8.5rem;
            @media (max-width: 1199px) {
                bottom: 3rem;
            }
        }
        .swiper-button-prev,
        .swiper-button-next {
            @media (max-width: 140rem) {
                display: none;
            }
        }
        .swiper-slide {
            height: 71.5rem;
            padding-top: 6em;
            padding-bottom: 14rem;

            @media (max-width: 1199px) {
                padding-bottom: 8rem;
            }

            @media (max-width: 767px) {
                height: 50rem;
            }

            @media (max-width: 479px) {
                padding-top: 3em;
            }

            // Image wrapper - acts like background container
            .slide-image-wrapper {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 2;
                overflow: hidden;
            }

            // Image - behaves like background-image: cover
            .slide-image {
                width: 100%;
                height: 100%;
                object-fit: cover;
                object-position: center -20rem;
                opacity: 0.5;

                @media (max-width: 2600px) and (min-width: 2000px) {
                    object-position: center center !important;
                }

                @media (max-width: 140rem) {
                    object-position: center center;
                }

                @media (max-width: 767px) {
                    opacity: 0.38;
                }
            }

            .slide-content {
                z-index: 3;
                position: relative;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: center;

                .hero-subtitle {
                    font-size: $fs-400;
                    font-weight: 500;
                    letter-spacing: 0.1rem;
                    color: $clr-primary;
                    margin-bottom: 1.5rem;

                    @media (max-width: 479px) {
                        font-size: 1.4rem;
                    }
                }
                h2.hero-title {
                    font-size: 5rem;
                    max-width: 52rem;
                    line-height: 1.2;
                    margin-bottom: 2.4rem;

                    @media (max-width: 479px) {
                        font-size: 3rem;
                    }
                }
                ul {
                    margin-bottom: 1.9rem;
                    max-width: 45rem;
                    li {
                        font-weight: 500;
                        display: flex;
                        margin-bottom: 0.5rem;

                        @media (max-width: 479px) {
                            font-weight: 400;
                        }
                        &:before {
                            content: '\eaaf';
                            font-family: $ff-icons;
                            font-size: 1.4rem;
                            color: $clr-primary;
                            margin-right: 1rem;
                        }
                    }
                }
                .btn {
                    font-size: 1.4rem;
                }
            }
        }
    }
</style>
