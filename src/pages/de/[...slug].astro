---
import { getCollection } from 'astro:content';
import ServiceDetail from '../../components/ServiceDetail.astro';
import ServiceSchema from '../../components/ServiceSchema.astro';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
    const serviceEntries = await getCollection('services', ({ id }) => {
        return id.startsWith('de/');
    });
    return serviceEntries.map((entry) => ({
        params: { slug: entry.slug.split('/').pop() },
        props: { entry },
    }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
const slugPart = entry.slug.split('/').pop();
---

<Layout title={entry.data.title} description={entry.data.description} image={entry.data.headerImage}>
    <ServiceSchema
        title={entry.data.title}
        description={entry.data.description}
        slug={slugPart}
        lang="de"
        image={entry.data.headerImage}
    />
    <ServiceDetail frontmatter={entry.data} Content={Content} lang="de" />
</Layout>
